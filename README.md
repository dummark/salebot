# MyCulto Telegram Bot

Телеграм-бот для магазина [MyCulto](https://myculto.ru/), позволяющий просматривать каталог, искать товары и навигировать по позициям прямо в чате.

## Возможности

- Получение каталога с сайта магазина и парсинг карточек товаров.
- Кеширование каталога на диске с автоматическим обновлением по расписанию.
- Команды Telegram-бота:
  - `/start` — приветствие и первый товар каталога.
  - `/categories` — список категорий с сайта.
  - `/category <номер>` — открыть категорию по номеру из списка.
  - `/search <запрос>` — поиск по загруженному каталогу.
  - `/refresh` — принудительное обновление кеша.
- Карточка товара содержит название, цену, наличие, ссылку, превью изображения (если доступно) и кнопки «Назад»/«Далее».
- Лёгкое логирование с поддержкой уровней (`info`, `warn`, `error`, `debug`) и обработкой ошибок.

## Требования

- Node.js 18+
- npm

## Установка

```bash
npm install
```

## Запуск

По умолчанию используется Long Polling:

```bash
npm run start
```

Для ручного обновления кеша без запуска бота можно воспользоваться скриптом:

```bash
npm run refresh
```

## Переменные окружения

Токен бота уже зашит в код по требованию. При необходимости его можно заменить в файле `src/config.js`.

## Перенос проекта в VS Code

Чтобы забрать проект целиком и открыть его в Visual Studio Code, выполните следующие шаги:

1. Склонируйте репозиторий (или скачайте архив) в удобную папку:
   ```bash
   git clone <URL_ВАШЕГО_РЕПОЗИТОРИЯ>
   cd salebot
   ```
2. Запустите Visual Studio Code и выберите команду **File → Open Folder…**.
3. Укажите папку проекта (ту, куда вы клонировали репозиторий) и нажмите **Open**.
4. Если VS Code предложит установить рекомендуемые расширения или запустить `npm install`, согласитесь — это подготовит среду для разработки.

После этого все файлы проекта будут доступны в интерфейсе VS Code, и вам не придётся копировать их вручную.

## Структура проекта

```
src/
  bot/
    index.js         # Логика бота, команды, карточки товаров
  data/
    catalog.js       # Получение каталога и парсинг товаров
  storage/
    catalogCache.js  # Файловый кеш каталога
  utils/
    consoleLogger.js # Настройка логирования
  index.js           # Точка входа, запуск бота
storage/
  catalog-cache.json # Файл для кеша (создаётся автоматически)
```

## Настройка вебхука

В проекте по умолчанию используется Long Polling. Чтобы переключиться на webhook, реализуйте запуск собственного веб-сервера (например, через `express`) и вызов `bot.launch({ webhook: { domain, hookPath } })` в `src/index.js`.

## Обновление по расписанию

Обновление кеша происходит каждые 60 минут благодаря `node-cron`. Период можно изменить в `src/config.js` (параметр `CACHE_TTL_MINUTES`).
